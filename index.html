<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSIF Castione - Gestione Accessi Professionale</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --securitas-blue: #003366; --securitas-red: #e30613; --bg: #f4f7f9; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 0; }
        
        /* Logo e Header */
        .banner-container { width: 100%; background: white; text-align: center; border-bottom: 3px solid var(--securitas-red); }
        .logo-img { width: 100%; max-width: 600px; height: auto; display: block; margin: 0 auto; }
        
        .container { width: 95%; max-width: 600px; margin: 20px auto; padding-bottom: 50px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); display: none; }
        .active { display: block; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { color: var(--securitas-blue); border-bottom: 2px solid #eee; padding-bottom: 10px; text-transform: uppercase; font-size: 1.2rem; }
        p { line-height: 1.6; color: #333; }

        /* Bottoni */
        button { width: 100%; padding: 18px; margin: 10px 0; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 1rem; transition: 0.2s; }
        .btn-next { background: var(--securitas-blue); color: white; }
        .btn-back { background: #6c757d; color: white; margin-top: 5px; }
        .btn-outline { background: white; border: 2px solid var(--securitas-blue); color: var(--securitas-blue); }
        button:hover { opacity: 0.9; }

        /* Form */
        .form-group { text-align: left; margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; color: var(--securitas-blue); }
        input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }

        /* Checklist */
        .process-box { background: #fff9db; border-left: 5px solid #fcc419; padding: 15px; margin: 15px 0; text-align: left; }
        .step-done { color: #2b8a3e; font-weight: bold; margin-bottom: 5px; display: block; }
    </style>
</head>
<body>

<div class="banner-container">
    <img src="logo_nsif.jpg" alt="NSIF Logo" class="logo-img" onerror="this.src='https://via.placeholder.com/600x150?text=Logo+NSIF+Castione'">
</div>

<div class="container">
    <div id="step_login" class="card active">
        <h2>Accesso Riservato</h2>
        <input type="password" id="pass_input" placeholder="Inserire Password" style="margin-bottom: 20px;">
        <button class="btn-next" onclick="checkAuth()">ENTRA</button>
    </div>

    <div id="step_main" class="card">
        <h2>Seleziona Collaboratore</h2>
        <button class="btn-next" onclick="goTo('step_oft_1')">DIPENDENTE OFT</button>
        <button class="btn-outline" onclick="alert('Processo FFS in sviluppo...')">DIPENDENTE FFS</button>
    </div>

    <div id="step_oft_1" class="card">
        <h2>Verifica Sistema</h2>
        <p>Il dipendente è presente nel sistema?</p>
        <button class="btn-next" onclick="goTo('step_oft_2')">SÌ, PRESENTE</button>
        <button class="btn-back" onclick="goTo('step_main')">INDIETRO</button>
    </div>

    <div id="step_oft_2" class="card">
        <h2>Verifica Foto</h2>
        <p>L'immagine è presente nel sistema?</p>
        <button class="btn-outline" onclick="goTo('step_oft_sit1_a')">NO, SENZA FOTO (Situazione 1)</button>
        <button class="btn-next">SÌ, CON FOTO</button>
        <button class="btn-back" onclick="goTo('step_oft_1')">INDIETRO</button>
    </div>

    <div id="step_oft_sit1_a" class="card">
        <h2>Situazione 1 - Azioni Iniziali</h2>
        <div class="process-box">
            1. Effettuare la foto dell'operaio.<br>
            2. Farsi consegnare un documento d'identità.<br>
            3. Preparare il badge provvisorio.<br>
            4. Comunicare: "A fine turno ritornare per il badge personale".
        </div>
        <button class="btn-next" onclick="goTo('step_oft_form')">PROCEDI ALLA STAMPA</button>
    </div>

    <div id="step_oft_form" class="card">
        <h2>Compilazione Modulo</h2>
        <div class="form-group">
            <label>Azienda:</label>
            <input type="text" id="f_azienda">
        </div>
        <div class="form-group">
            <label>Nome:</label>
            <input type="text" id="f_nome">
        </div>
        <div class="form-group">
            <label>Cognome:</label>
            <input type="text" id="f_cognome">
        </div>
        <div class="form-group">
            <label>Codice Badge:</label>
            <input type="text" id="f_badge">
        </div>
        <button class="btn-next" onclick="generatePDF()">GENERA PDF E PROSEGUI</button>
    </div>

    <div id="step_oft_sit1_b" class="card">
        <h2>Situazione 1 - Logistica Moduli</h2>
        <div class="process-box">
            <span class="step-done">✓ Dati registrati e PDF creato</span>
            5. Segnare l'operazione nel file Excel.<br>
            6. Consegnare Badge e Modulo a <b>Loris Zatta</b>.<br>
            7. Attendere riconsegna da Loris Zatta.<br>
            8. Lasciare il modulo a <b>La Morgia</b> per verifica.
        </div>
        <button class="btn-next" onclick="goTo('step_oft_final')">CONFERMA CONSEGNA A LA MORGIA</button>
    </div>

    <div id="step_oft_final" class="card">
        <h2>Chiusura Processo (T3)</h2>
        <div class="process-box">
            9. La Morgia verifica e lascia nella cassetta.<br>
            10. T3 preleva il modulo dalla cassetta.<br>
            11. T3 verifica registrazione tramite Excel.<br>
            12. T3 inserisce il modulo nel classificatore.
        </div>
        <p style="color: green; font-weight: bold; font-size: 1.4rem;">COMPITO TERMINATO</p>
        <button class="btn-next" onclick="location.reload()">NUOVA OPERAZIONE</button>
    </div>
</div>

<script>
    function checkAuth() {
        if(document.getElementById('pass_input').value === "Securitas2026") goTo('step_main');
        else alert("Password errata");
    }

    function goTo(id) {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        const az = document.getElementById('f_azienda').value;
        const nom = document.getElementById('f_nome').value;
        const cog = document.getElementById('f_cognome').value;
        const bdg = document.getElementById('f_badge').value;

        doc.setFontSize(22);
        doc.text("MODULO REGISTRAZIONE BADGE", 20, 30);
        doc.setFontSize(14);
        doc.text(`Azienda: ${az}`, 20, 50);
        doc.text(`Collaboratore: ${nom} ${cog}`, 20, 60);
        doc.text(`ID Badge: ${bdg}`, 20, 70);
        doc.text("--------------------------------------------------", 20, 80);
        doc.setFontSize(10);
        doc.text("Testo procedurale standard NSIF Castione.", 20, 90);
        doc.text("Il presente modulo deve essere verificato da La Morgia e archiviato dal T3.", 20, 100);

        doc.save(`Badge_${cog}.pdf`);
        goTo('step_oft_sit1_b');
    }
</script>

</body>
</html>
